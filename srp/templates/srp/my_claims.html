{% extends "base.html" %}
{% block content %}
{% load humanize %}

<h2>My SRP Claims</h2>

{% if claims %}
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th>ID</th>
        <th>Submitted</th>
        <th>Submitter</th>
        <th>Victim</th>
        <th>Ship</th>
        <th>Category</th>
        <th>System</th>
        <th>Status</th>
        <th>Payout (ISK)</th>
        <th>Processed</th>
        <th>Paid</th>
        <th style="width:110px;" >View</th>
      </tr>
    </thead>
    <tbody>
    {% for claim in claims %}
      <tr>
        <td>#{{ claim.id }}</td>
        <td>{{ claim.submitted_at|date:"Y-m-d H:i" }}</td>
        <td>{{ claim.submitter.username }}</td>
        <td>{{ claim.victim_character_name|default:"—" }}</td>
        <td>
          {% if claim.ship %}
            {{ claim.ship.ship_name }}
          {% else %}
            —
          {% endif %}
        </td>
        <td>{{ claim.get_category_display }}</td>
        <td>{{ claim.system|default:"—" }}</td>
        <td>{{ claim.get_status_display }}</td>
        <td>{{ claim.payout_amount|floatformat:0|intcomma }}</td>
        <td>
          {% if claim.processed_at %}
            {{ claim.processed_at|date:"Y-m-d H:i" }}
          {% else %}
            —
          {% endif %}
        </td>
        <td>
          {% if claim.paid_at %}
            {{ claim.paid_at|date:"Y-m-d H:i" }}
          {% else %}
            —
          {% endif %}
        </td>
        <td>
          <a class="btn btn-info btn-sm text-dark" href="{% url 'srp:claim_detail' claim.id %}">
            View
          </a>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>You haven’t submitted any SRP claims yet.</p>
{% endif %}

{% endblock %}
